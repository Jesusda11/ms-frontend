<div>
  <form [formGroup]="theFormGroup" (ngSubmit)="submitForm()">
    <div class="card shadow">
      <!-- Card Header -->
      <div class="card-header">
        <h3 *ngIf="mode === 1">Visualizar</h3>
        <h3 *ngIf="mode === 2">Crear</h3>
        <h3 *ngIf="mode === 3">Actualizar</h3>
      </div>

      <!-- Card Body -->
      <div class="card-body">
        <!-- ID Field (Disabled unless Creating mode) -->
        <div *ngIf="mode !== 2" class="form-group">
          <label>Id:</label>
          <input
            type="text"
            class="form-control"
            disabled
            formControlName="id"
            [ngClass]="{'inputInvalido': trySend && theFormGroup.get('id')?.errors}"
          />
        </div>

        <br />

        <!-- Preferencias Field -->
        <div class="form-group">
          <label>Preferencias:</label>
          <input
            type="text"
            class="form-control"
            formControlName="preferencias"
            [ngClass]="{'inputInvalido': trySend && theFormGroup.get('preferencias')?.errors}"
          />
        </div>

        <!-- Persona Natural Toggle -->
        <div *ngIf="mode === 2" class="mt-3">
          <label>¿Agregar Persona Natural?</label>
          <button
            class="btn btn-primary"
            type="button"
            (click)="togglePersonaNatural()"
          >
            {{ showPersonaNaturalForm ? 'Ocultar' : 'Agregar' }}
          </button>
        </div>

        <!-- Persona Natural Form -->
        <div *ngIf="showPersonaNaturalForm" class="mt-4">
          <h5>Datos de Persona Natural</h5>

          <!-- Nacionalidad -->
          <div class="form-group">
            <label>Nacionalidad:</label>
            <input
              type="text"
              class="form-control"
              formControlName="nacionalidad"
              [ngClass]="{'inputInvalido': trySend && theFormGroup.get('nacionalidad')?.errors}"
            />
          </div>

          <!-- Género -->
          <div class="form-group">
            <label>Género:</label>
            <input
              type="text"
              class="form-control"
              formControlName="genero"
              [ngClass]="{'inputInvalido': trySend && theFormGroup.get('genero')?.errors}"
            />
          </div>

          <!-- Usuario ID -->
          <div class="form-group">
            <label>Usuario ID:</label>
            <div class="col-8">
              <select
                class="form-control"
                [disabled]="mode === 1"
                formControlName="usuario_id"
                [ngClass]="{'inputInvalido': trySend && theFormGroup.get('usuario_id')?.errors}"
              >
                <option
                  [value]="usuario._id"
                  *ngFor="let usuario of usuarios"
                >
                  {{ usuario._id }}. {{ usuario.name }}
                </option>
              </select>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="mt-4">
          <button *ngIf="mode === 2" class="btn btn-success" type="submit">
            Crear
          </button>
          <button *ngIf="mode === 3" class="btn btn-success" type="submit">
            Actualizar
          </button>
        </div>
      </div>
    </div>

    <!-- Extra Actions for Visualize Mode -->
    <div class="row mt-3" *ngIf="mode === 1">
      <div class="col-4"></div>
      <div class="col-8">
        <button
          class="btn btn-primary btn-block"
          (click)="showProductos(cliente.id)"
        >
          Ver productos
        </button>
        <button
          class="btn btn-primary btn-block"
          (click)="showContracts(cliente.id)"
        >
          Ver Contratos
        </button>
      </div>
    </div>
  </form>
</div>
